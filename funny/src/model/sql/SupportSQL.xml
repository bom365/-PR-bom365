<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="SupportSQL">
    <insert id="insertREG" parameterType="SupportREGDTO">
  		  	Insert INTO support_regular VALUES ((select NVL(MAX(regular_number),0)+1 FROM support_regular), #{supporter_id}, #{regular_amount},#{regular_bank},#{regular_account},#{regular_date},default)
    </insert>
    <insert id="insertTEM" parameterType="SupportTEMDTO">
  		 	Insert INTO support_temporary VALUES ((select NVL(MAX(temporary_number),0)+1 FROM support_temporary), #{supporter_id}, #{temporary_amount}, to_char(sysdate, 'yyyy/mm/dd hh24:mi'))
    </insert>
    <update id="setREGEnd" parameterType="string">
    		UPDATE support_regular SET regular_end = to_char(sysdate, 'yy/mm/dd') WHERE supporter_id = #{supporter_id}
    </update>
    
   	<!-- login -->
    <select id="SupportREGEndCheck" parameterType="string" resultType="string">
    		SELECT regular_end FROM support_regular WHERE supporter_id = #{supporter_id}
    </select> 

   	<!-- my page -->
    <select id="mypageREG" parameterType="string" resultType="SupportREGDTO">
		SELECT * FROM support_regular WHERE supporter_id = #{supporter_id}   
	</select>     
    <select id="mypageTEM" parameterType="string" resultType="SupportTEMDTO">
    	SELECT * from support_temporary where supporter_id=#{supporter_id} order by temporary_number desc
    </select> 
    
   	<!-- 관리자 페이지 -->
     <select id="AdminREGSelectAll" parameterType="SupportREGDTO" resultType="SupportREGDTO">
		SELECT * FROM support_regular
	</select> 
     <select id="AdminTEMSelectAll" parameterType="SupportTEMDTO" resultType="SupportTEMDTO">
		SELECT * from support_temporary
    </select> 
    <select id="AdminREGAmountSelectAll" parameterType="SupportREGDTO" resultType="SupportREGDTO">
    		SELECT regular_number, supporter_id, to_char(regular_amount, '999,999,999') AS regular_amount, regular_bank, regular_account, SUBSTRB(TO_DATE(regular_date,'yy/mm/dd'),1,14) AS regular_date, regular_end FROM SUPPORT_REGULAR ORDER BY regular_amount DESC
    </select>
     <select id="AdminTEMAmountSelectAll" parameterType="SupportTEMDTO" resultType="SupportTEMDTO">
			SELECT temporary_number, supporter_id,to_char(temporary_amount, '999,999,999') AS temporary_amount, SUBSTRB(TO_DATE(temporary_date,'yy/mm/dd'),1,8) AS temporary_date FROM support_temporary ORDER BY temporary_amount DESC
	</select>
</mapper>